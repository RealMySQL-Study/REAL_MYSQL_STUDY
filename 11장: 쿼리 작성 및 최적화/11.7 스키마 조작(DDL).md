# 스키마 조작(DDL)
MySQL 서버가 업그레이드 되면서 많은 DDL이 온라인 모드로 처리될 수 있게 개선됐지만  
여전히 스키마를 변경하는 작업 중에는 상당히 오랜 시간이 걸리고 많은 부하를 발생시키는 작업들이 있으므로 주의해야한다.  

### 온라인 DDL
MySQL 5.5 이전 버전까지는 테이블의 구조를 변경하는 동안 다른 커넥션에서 DML을 실행할 수 없었다.  
하지만 8.0 버전으로 업그레이드 되면서 대부분의 스키마 변경 작업은 서버에 내장된 온라인 DDL기능으로 처리가 가능해졌다.  

### 온라인 DDL알고리즘
온라인 DDL은 스키마를 변경하는 작업 도중에도 다른 커넥션에서 해당 테이블의 데이터를 변경하거나 조회하는 작업을 가능하게한다.  
ALTER TABLE 명령을 실행하면 다음과 같은 순서로 스키마 변경에 적합한 알고리즘을 찾는다.  
1. ALGORITHM=INSTANT로 스키마 변경이 가능한지 확인 후 선택
2. ALGORITHM=INPLACE로 스키마 변경이 가능한지 확인 후 선택
3. ALGORITHM=COPY 알고리즘 선택

* INSTANT
  * 테이블의 데이터는 전혀 변경하지 않고, 메타데이터만 변경하고 작업 완료.
  * 레코드 건수와 무관하게 작업시간은 매우 짧다.
  * 스키마 변경 도중 테이블의 읽고 쓰기는 대기하게 되지만 변경 시간이 매우 짧기 때문에 크게 영향을 미치지 않음.
* INPLACE
  * 임시 테이블로 데이터를 복사하지 않고 스키마 변경을 실행.
  * 레코드의 복사 작업은 없지만 테이블의 크기에 따라 많은 시간이 소요될 수있다.
  * 스키마 변경 작업 도중에도 테이블의 읽기 쓰기 전부 가능.
  * 다른 커넥션의 쿼리 처리에 대한 영향도는 높지 않다.
* COPY
  * 변경된 스키마를 적용한 임시 테이블을 생성하고, 테이블의 레코드를 모두 임시 테이블로 복사한 후 최종적으로 임시 테이블을 RENAME해서 스키마 변경을 완료한다.
  * 테이브르이 읽기만 가능하고 DML을 실행할 수 없다.
 
온라인 DDL명령은 ALGORITHM과 LOCK옵션이 명시되어 있지 않다면 MYSQL 서버가 적절한 수준의 알고리즘과 잠금 수준을 선택한다.  
``` sql
ALTER TABLEs= salaries CHANGE to_date end_date DATE NOT NULL, AGORITHE=INPLACE, LOCK=NONE
```  
