## B-Tree 인덱스를 통한 데이터 읽기
스토리지 엔진이 어떻게 인덱스를 이용해서 실제 레코드를 읽어내는지 알아야한다.  

### 인덱스 레인지스캔
인덱스 레인지 스캔은 인덱스의 접근 방법 가운데 가장 대표적인 접근 방식이다.  
인덱스를 통해 레코드를 한 건만 읽는 경우(index unique scan)와 한 건 이상을 읽는 경우(index range scan)를 각각 다른 이름으로 구분하지만  
지금은 모두 묶어서 `인덱스 레인지 스캔`이라고 표현한다.  

'''  
SELECT * FROM employees WHERE first_name BETWEEN 'Ebbe' AND 'Gad';
'''  
![image](https://github.com/RealMySQL-Study/REAL_MYSQL_STUDY/assets/67637716/f1eb3995-2b08-4b53-8b41-fe3a5530a6c4)  

위와 같은 쿼리에서 루트노드에서부터 비교를 시작해 브랜치 노드를 거치고 최종적으로 리프 노드까지 찾아 들어가야만  
필요한 레코드 시작 지점을 알 수 있다.  
일단 시작해야 할 위치를 찾으면 리프노드의 레코드만 순서대로 읽으면 된다.  
그리고 최종적으로 스캔을 멈춰야 할 위치에 다다르면 지금까지 읽은 레코드를 사용자에게 반환하고 쿼리를 끝낸다.  

위는 실제 인덱스 만을 읽는 경우고, 실제 데이터 파일의 레코드를 읽어와야 하는 경우를 살펴보자.  

![image](https://github.com/RealMySQL-Study/REAL_MYSQL_STUDY/assets/67637716/a6183942-f942-45df-9852-e4405404715d)  
B-Tree 인덱스에서 스캔 시작위치에서부터 검색 조건에 일치하는 건들은 데이터 파일에서 레코드를 읽어온다.  
이때 레코드 한 건 한 건 단위로 랜덤 I/O가 일어난다.  

* 인덱스 레인지 스캔 단계
1. 인덱스에서 조건을 만족하는 값이 저장된 위치를 찾는다. (인덱스 탐색)
2. 1번에서 탐색된 위치부터 필요한 만큼 인덱스를 차례대로 읽는다. (인덱스 스캔)
3. 2번에서 읽어 들인 인덱스 키와 레코드 주소를 이용해 레코드가 저장된 페이지를 가져오고 최종 레코드를 읽어온다.

##### 커버링 인덱스
커버링 인덱스는 쿼리를 충족시키는데 필요한 모든 데이터를 갖고 있는 인덱스를 말한다.  
커버링 인덱스로 처리되는 쿼리는 디스크의 레코드를 읽지않아도 되기 때문에 랜덤 읽기가 상당히 줄어들다.  

### 인덱스 풀 스캔
![image](https://github.com/RealMySQL-Study/REAL_MYSQL_STUDY/assets/67637716/384d2b86-6457-43aa-9955-9fe75b4010c5)  
인덱스 레인지 스캔과는 달리 인덱스의 처음부터 끝까지 모두 읽는 방식을 말한다.  
대표적으로 쿼리의 조건절에 사용된 컬럼이 인덱스의 첫 번째 칼러럼이 아닌 경우 인덱스 풀 스캔 방식이 사용된다.  
예를 들면, 인덱스는 (A, B, C)칼럼의 순서로 만들어져 있지만 쿼리의 조건절은 B칼럼이나 C칼럼으로 시작되는 경우다.  
이 방식은 인덱스 레인지 스캔보다는 빠르진 않지만 테이블 풀 스캔보다는 효율적이다.  
커버링 인덱스일 경우, 테이블 전체를 읽는 것보다는 적은 I/O로 쿼리를 처리할 수 있다.  




 
